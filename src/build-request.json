{
  "kind": "build_request",
  "title": "Add deterministic AI-style conversation practice mode",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-10",
      "text": "Add a new Conversation Practice mode that lets authenticated users practice short, turn-based text conversations using deterministic (non-LLM) logic and the user’s existing vocabulary.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-9"
        ],
        "quotes": [
          "pero pon una ia para practicar conversaciòn"
        ]
      },
      "acceptanceCriteria": [
        "A new route exists at \"/conversation\" and is protected by the existing AuthGate behavior (unauthenticated users see the landing experience).",
        "The Conversation page provides a chat-style UI with a clear start/reset flow and a visible indication of whose turn it is (Learner vs Partner).",
        "Conversation prompts and expected responses are generated deterministically from the user’s vocabulary (and optional notes), without calling any external APIs.",
        "When vocabulary is empty, the Conversation page shows an actionable empty state linking to \"/vocabulary\"."
      ]
    },
    {
      "id": "REQ-11",
      "text": "Expose Conversation Practice in the app navigation and dashboard so users can easily discover and start it.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-9"
        ],
        "quotes": [
          "pero pon una ia para practicar conversaciòn"
        ]
      },
      "acceptanceCriteria": [
        "Top navigation includes a new link labeled \"Conversation\" that routes to \"/conversation\" and shows an active state when selected (desktop and mobile nav).",
        "Dashboard includes a new quick action card/button that links to \"/conversation\" alongside the existing Practice and Vocabulary actions."
      ]
    },
    {
      "id": "REQ-12",
      "text": "Provide per-turn “AI Tutor” feedback for conversation replies using the existing deterministic tutor heuristics (normalization + typo tolerance), and record the turn outcome against the relevant vocabulary item using the existing practice-result submission flow.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-9"
        ],
        "quotes": [
          "pero pon una ia para practicar conversaciòn"
        ]
      },
      "acceptanceCriteria": [
        "After the user sends a message, the UI evaluates the user message against one or more acceptable expected replies using deterministic matching (reusing the existing tutor feedback approach).",
        "The user sees feedback in-app (correct/incorrect + hint/suggestion) consistent with the current TutorPanel style and copy tone (English).",
        "Each conversation turn is associated with a specific vocabulary item used to generate that turn, and the app submits pass/fail using the existing submit practice result mutation so vocab stats/lastSeen update accordingly.",
        "No new backend methods are required for this feature (it must work using existing queries/mutations and local UI state)."
      ]
    }
  ],
  "constraints": [
    "Do not call any external LLM or third-party AI APIs; the conversation coach must be fully deterministic/offline.",
    "Do not modify files under frontend/src/components/ui, frontend/src/hooks/useInternetIdentity.ts(x), frontend/src/hooks/useActor.ts, frontend/src/main.tsx.",
    "Backend must remain single-actor; introduce backend changes only if strictly necessary (prefer reusing existing submitPracticeResult for stats)."
  ],
  "nonGoals": [
    "Voice/speech input or pronunciation scoring.",
    "Real-time chat, WebSockets, or multi-user conversations.",
    "Third-party authentication beyond Internet Identity.",
    "Persisting full chat transcripts on the backend (local session UI state is sufficient for now)."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}